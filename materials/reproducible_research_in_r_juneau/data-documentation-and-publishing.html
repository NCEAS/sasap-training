<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Reproducible Analysis With R</title>
  <meta name="description" content="Practical open science approaches to salmon data management, analysis, and synthesis">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="Reproducible Analysis With R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Practical open science approaches to salmon data management, analysis, and synthesis" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Reproducible Analysis With R" />
  
  <meta name="twitter:description" content="Practical open science approaches to salmon data management, analysis, and synthesis" />
  




  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="publication-graphics-with-ggplot2.html">
<link rel="next" href="publishing-analyses-to-the-web.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-1.3/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.4/datatables.js"></script>
<link href="libs/dt-core-1.10.16/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.16/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.16/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/Proj4Leaflet-1.0.1/proj4-compressed.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.0.2/leaflet.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Reproducible Analysis With R</a></li>
<li><a href="/sasap-training/">← Back to main website</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#the-reproducibility-crisis"><i class="fa fa-check"></i><b>1.1</b> The Reproducibility Crisis</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#what-is-needed-for-computational-reproducibility"><i class="fa fa-check"></i><b>1.2</b> What is needed for computational reproducibility?</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#conceptualizing-workflows"><i class="fa fa-check"></i><b>1.3</b> Conceptualizing workflows</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#course-objectives"><i class="fa fa-check"></i><b>1.4</b> Course Objectives</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#course-details"><i class="fa fa-check"></i><b>1.5</b> Course details</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="example-brood-table-analysis.html"><a href="example-brood-table-analysis.html"><i class="fa fa-check"></i><b>2</b> Example: Brood Table Analysis</a><ul>
<li class="chapter" data-level="2.1" data-path="example-brood-table-analysis.html"><a href="example-brood-table-analysis.html#introduction-1"><i class="fa fa-check"></i><b>2.1</b> Introduction</a></li>
<li class="chapter" data-level="2.2" data-path="example-brood-table-analysis.html"><a href="example-brood-table-analysis.html#datasets"><i class="fa fa-check"></i><b>2.2</b> Datasets</a></li>
<li class="chapter" data-level="2.3" data-path="example-brood-table-analysis.html"><a href="example-brood-table-analysis.html#reformatting"><i class="fa fa-check"></i><b>2.3</b> Reformatting</a><ul>
<li class="chapter" data-level="2.3.1" data-path="example-brood-table-analysis.html"><a href="example-brood-table-analysis.html#batch-reformatting"><i class="fa fa-check"></i><b>2.3.1</b> Batch Reformatting</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="example-brood-table-analysis.html"><a href="example-brood-table-analysis.html#merging"><i class="fa fa-check"></i><b>2.4</b> Merging</a></li>
<li class="chapter" data-level="2.5" data-path="example-brood-table-analysis.html"><a href="example-brood-table-analysis.html#quality-assurance"><i class="fa fa-check"></i><b>2.5</b> Quality Assurance</a><ul>
<li class="chapter" data-level="2.5.1" data-path="example-brood-table-analysis.html"><a href="example-brood-table-analysis.html#acceptable-values"><i class="fa fa-check"></i><b>2.5.1</b> Acceptable values</a></li>
<li class="chapter" data-level="2.5.2" data-path="example-brood-table-analysis.html"><a href="example-brood-table-analysis.html#questionable-data"><i class="fa fa-check"></i><b>2.5.2</b> Questionable data</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="example-brood-table-analysis.html"><a href="example-brood-table-analysis.html#analysis"><i class="fa fa-check"></i><b>2.6</b> Analysis</a><ul>
<li class="chapter" data-level="2.6.1" data-path="example-brood-table-analysis.html"><a href="example-brood-table-analysis.html#relationship-between-1.2s-and-1.3s-by-region"><i class="fa fa-check"></i><b>2.6.1</b> Relationship between 1.2s and 1.3s by Region</a></li>
<li class="chapter" data-level="2.6.2" data-path="example-brood-table-analysis.html"><a href="example-brood-table-analysis.html#relationship-between-1.2s-and-1.3s-by-region-1"><i class="fa fa-check"></i><b>2.6.2</b> Relationship between 1.2s and 1.3s by Region</a></li>
<li class="chapter" data-level="2.6.3" data-path="example-brood-table-analysis.html"><a href="example-brood-table-analysis.html#relationship-between-1.2s-and-1.3s-by-stock"><i class="fa fa-check"></i><b>2.6.3</b> Relationship between 1.2s and 1.3s by Stock</a></li>
<li class="chapter" data-level="2.6.4" data-path="example-brood-table-analysis.html"><a href="example-brood-table-analysis.html#age-diversity"><i class="fa fa-check"></i><b>2.6.4</b> Age Diversity</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="rstudio-and-gitgithub-setup.html"><a href="rstudio-and-gitgithub-setup.html"><i class="fa fa-check"></i><b>3</b> RStudio and Git/GitHub Setup</a><ul>
<li class="chapter" data-level="3.1" data-path="rstudio-and-gitgithub-setup.html"><a href="rstudio-and-gitgithub-setup.html#learning-objectives"><i class="fa fa-check"></i><b>3.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="3.2" data-path="rstudio-and-gitgithub-setup.html"><a href="rstudio-and-gitgithub-setup.html#checking-the-rstudio-environment"><i class="fa fa-check"></i><b>3.2</b> Checking the RStudio environment</a><ul>
<li class="chapter" data-level="3.2.1" data-path="rstudio-and-gitgithub-setup.html"><a href="rstudio-and-gitgithub-setup.html#r-studio-version"><i class="fa fa-check"></i><b>3.2.1</b> R Studio Version</a></li>
<li class="chapter" data-level="3.2.2" data-path="rstudio-and-gitgithub-setup.html"><a href="rstudio-and-gitgithub-setup.html#package-installation"><i class="fa fa-check"></i><b>3.2.2</b> Package installation</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="rstudio-and-gitgithub-setup.html"><a href="rstudio-and-gitgithub-setup.html#setting-up-git"><i class="fa fa-check"></i><b>3.3</b> Setting up git</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="literate-analysis-with-rmarkdown.html"><a href="literate-analysis-with-rmarkdown.html"><i class="fa fa-check"></i><b>4</b> Literate Analysis with RMarkdown</a><ul>
<li class="chapter" data-level="4.1" data-path="literate-analysis-with-rmarkdown.html"><a href="literate-analysis-with-rmarkdown.html#learning-objectives-1"><i class="fa fa-check"></i><b>4.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="4.2" data-path="literate-analysis-with-rmarkdown.html"><a href="literate-analysis-with-rmarkdown.html#what-is-rmarkdown"><i class="fa fa-check"></i><b>4.2</b> What is (R)Markdown?</a></li>
<li class="chapter" data-level="4.3" data-path="literate-analysis-with-rmarkdown.html"><a href="literate-analysis-with-rmarkdown.html#whats-possible-with-rmarkdown"><i class="fa fa-check"></i><b>4.3</b> What’s possible with RMarkdown</a></li>
<li class="chapter" data-level="4.4" data-path="literate-analysis-with-rmarkdown.html"><a href="literate-analysis-with-rmarkdown.html#rmarkdown-overview"><i class="fa fa-check"></i><b>4.4</b> RMarkdown overview</a><ul>
<li class="chapter" data-level="4.4.1" data-path="literate-analysis-with-rmarkdown.html"><a href="literate-analysis-with-rmarkdown.html#knitting-the-file"><i class="fa fa-check"></i><b>4.4.1</b> Knitting the file</a></li>
<li class="chapter" data-level="4.4.2" data-path="literate-analysis-with-rmarkdown.html"><a href="literate-analysis-with-rmarkdown.html#basic-formatting"><i class="fa fa-check"></i><b>4.4.2</b> Basic formatting</a></li>
<li class="chapter" data-level="4.4.3" data-path="literate-analysis-with-rmarkdown.html"><a href="literate-analysis-with-rmarkdown.html#links"><i class="fa fa-check"></i><b>4.4.3</b> Links</a></li>
<li class="chapter" data-level="4.4.4" data-path="literate-analysis-with-rmarkdown.html"><a href="literate-analysis-with-rmarkdown.html#images"><i class="fa fa-check"></i><b>4.4.4</b> Images</a></li>
<li class="chapter" data-level="4.4.5" data-path="literate-analysis-with-rmarkdown.html"><a href="literate-analysis-with-rmarkdown.html#r-code-chunks"><i class="fa fa-check"></i><b>4.4.5</b> R Code Chunks</a></li>
<li class="chapter" data-level="4.4.6" data-path="literate-analysis-with-rmarkdown.html"><a href="literate-analysis-with-rmarkdown.html#inline-r-expressions-and-equations"><i class="fa fa-check"></i><b>4.4.6</b> Inline R expressions and equations</a></li>
<li class="chapter" data-level="4.4.7" data-path="literate-analysis-with-rmarkdown.html"><a href="literate-analysis-with-rmarkdown.html#plots"><i class="fa fa-check"></i><b>4.4.7</b> Plots</a></li>
<li class="chapter" data-level="4.4.8" data-path="literate-analysis-with-rmarkdown.html"><a href="literate-analysis-with-rmarkdown.html#tables"><i class="fa fa-check"></i><b>4.4.8</b> Tables</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="literate-analysis-with-rmarkdown.html"><a href="literate-analysis-with-rmarkdown.html#literate-analysis-with-rmarkdown-1"><i class="fa fa-check"></i><b>4.5</b> Literate analysis with RMarkdown</a></li>
<li class="chapter" data-level="4.6" data-path="literate-analysis-with-rmarkdown.html"><a href="literate-analysis-with-rmarkdown.html#organizing-a-reproducible-research-folder"><i class="fa fa-check"></i><b>4.6</b> Organizing a reproducible research folder</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="version-control-with-git-and-github.html"><a href="version-control-with-git-and-github.html"><i class="fa fa-check"></i><b>5</b> Version Control With git and GitHub</a><ul>
<li class="chapter" data-level="5.1" data-path="version-control-with-git-and-github.html"><a href="version-control-with-git-and-github.html#learning-objectives-2"><i class="fa fa-check"></i><b>5.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="5.2" data-path="version-control-with-git-and-github.html"><a href="version-control-with-git-and-github.html#the-problem-with-filenames"><i class="fa fa-check"></i><b>5.2</b> The problem with filenames</a></li>
<li class="chapter" data-level="5.3" data-path="version-control-with-git-and-github.html"><a href="version-control-with-git-and-github.html#version-control-and-collaboration-using-git-and-github"><i class="fa fa-check"></i><b>5.3</b> Version control and Collaboration using Git and GitHub</a></li>
<li class="chapter" data-level="5.4" data-path="version-control-with-git-and-github.html"><a href="version-control-with-git-and-github.html#lets-look-at-a-github-repository"><i class="fa fa-check"></i><b>5.4</b> Let’s look at a GitHub repository</a></li>
<li class="chapter" data-level="5.5" data-path="version-control-with-git-and-github.html"><a href="version-control-with-git-and-github.html#the-git-lifecycle"><i class="fa fa-check"></i><b>5.5</b> The Git lifecycle</a></li>
<li class="chapter" data-level="5.6" data-path="version-control-with-git-and-github.html"><a href="version-control-with-git-and-github.html#create-a-remote-repository-on-github"><i class="fa fa-check"></i><b>5.6</b> Create a remote repository on GitHub</a></li>
<li class="chapter" data-level="5.7" data-path="version-control-with-git-and-github.html"><a href="version-control-with-git-and-github.html#working-locally-with-git-via-rstudio"><i class="fa fa-check"></i><b>5.7</b> Working locally with Git via RStudio</a></li>
<li class="chapter" data-level="5.8" data-path="version-control-with-git-and-github.html"><a href="version-control-with-git-and-github.html#on-good-commit-messages"><i class="fa fa-check"></i><b>5.8</b> On good commit messages</a></li>
<li class="chapter" data-level="5.9" data-path="version-control-with-git-and-github.html"><a href="version-control-with-git-and-github.html#collaboration-and-conflict-free-workflows"><i class="fa fa-check"></i><b>5.9</b> Collaboration and conflict free workflows</a></li>
<li class="chapter" data-level="5.10" data-path="version-control-with-git-and-github.html"><a href="version-control-with-git-and-github.html#exercise"><i class="fa fa-check"></i><b>5.10</b> Exercise</a></li>
<li class="chapter" data-level="5.11" data-path="version-control-with-git-and-github.html"><a href="version-control-with-git-and-github.html#advanced-topics"><i class="fa fa-check"></i><b>5.11</b> Advanced topics</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="data-modeling-tidy-data.html"><a href="data-modeling-tidy-data.html"><i class="fa fa-check"></i><b>6</b> Data Modeling &amp; Tidy Data</a><ul>
<li class="chapter" data-level="6.1" data-path="data-modeling-tidy-data.html"><a href="data-modeling-tidy-data.html#learning-objectives-3"><i class="fa fa-check"></i><b>6.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="6.2" data-path="data-modeling-tidy-data.html"><a href="data-modeling-tidy-data.html#benefits-of-relational-data-systems"><i class="fa fa-check"></i><b>6.2</b> Benefits of relational data systems</a></li>
<li class="chapter" data-level="6.3" data-path="data-modeling-tidy-data.html"><a href="data-modeling-tidy-data.html#data-organization"><i class="fa fa-check"></i><b>6.3</b> Data Organization</a></li>
<li class="chapter" data-level="6.4" data-path="data-modeling-tidy-data.html"><a href="data-modeling-tidy-data.html#multiple-tables"><i class="fa fa-check"></i><b>6.4</b> Multiple tables</a></li>
<li class="chapter" data-level="6.5" data-path="data-modeling-tidy-data.html"><a href="data-modeling-tidy-data.html#inconsistent-observations"><i class="fa fa-check"></i><b>6.5</b> Inconsistent observations</a></li>
<li class="chapter" data-level="6.6" data-path="data-modeling-tidy-data.html"><a href="data-modeling-tidy-data.html#inconsistent-variables"><i class="fa fa-check"></i><b>6.6</b> Inconsistent variables</a></li>
<li class="chapter" data-level="6.7" data-path="data-modeling-tidy-data.html"><a href="data-modeling-tidy-data.html#marginal-sums-and-statistics"><i class="fa fa-check"></i><b>6.7</b> Marginal sums and statistics</a></li>
<li class="chapter" data-level="6.8" data-path="data-modeling-tidy-data.html"><a href="data-modeling-tidy-data.html#good-enough-data-modeling"><i class="fa fa-check"></i><b>6.8</b> Good enough data modeling</a><ul>
<li class="chapter" data-level="6.8.1" data-path="data-modeling-tidy-data.html"><a href="data-modeling-tidy-data.html#denormalized-data"><i class="fa fa-check"></i><b>6.8.1</b> Denormalized data</a></li>
<li class="chapter" data-level="6.8.2" data-path="data-modeling-tidy-data.html"><a href="data-modeling-tidy-data.html#tabular-data"><i class="fa fa-check"></i><b>6.8.2</b> Tabular data</a></li>
</ul></li>
<li class="chapter" data-level="6.9" data-path="data-modeling-tidy-data.html"><a href="data-modeling-tidy-data.html#primary-and-foreign-keys"><i class="fa fa-check"></i><b>6.9</b> Primary and Foreign Keys</a></li>
<li class="chapter" data-level="6.10" data-path="data-modeling-tidy-data.html"><a href="data-modeling-tidy-data.html#entity-relationship-model-er"><i class="fa fa-check"></i><b>6.10</b> Entity-Relationship Model (ER)</a></li>
<li class="chapter" data-level="6.11" data-path="data-modeling-tidy-data.html"><a href="data-modeling-tidy-data.html#merging-data"><i class="fa fa-check"></i><b>6.11</b> Merging data</a></li>
<li class="chapter" data-level="6.12" data-path="data-modeling-tidy-data.html"><a href="data-modeling-tidy-data.html#simple-guidelines-for-effective-data"><i class="fa fa-check"></i><b>6.12</b> Simple Guidelines for Effective Data</a></li>
<li class="chapter" data-level="6.13" data-path="data-modeling-tidy-data.html"><a href="data-modeling-tidy-data.html#data-modeling-exercise"><i class="fa fa-check"></i><b>6.13</b> Data modeling exercise</a></li>
<li class="chapter" data-level="6.14" data-path="data-modeling-tidy-data.html"><a href="data-modeling-tidy-data.html#related-resources"><i class="fa fa-check"></i><b>6.14</b> Related resources</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="data-cleaning-and-manipulation.html"><a href="data-cleaning-and-manipulation.html"><i class="fa fa-check"></i><b>7</b> Data Cleaning and Manipulation</a><ul>
<li class="chapter" data-level="7.1" data-path="data-cleaning-and-manipulation.html"><a href="data-cleaning-and-manipulation.html#learning-objectives-4"><i class="fa fa-check"></i><b>7.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="7.2" data-path="data-cleaning-and-manipulation.html"><a href="data-cleaning-and-manipulation.html#introduction-2"><i class="fa fa-check"></i><b>7.2</b> Introduction</a></li>
<li class="chapter" data-level="7.3" data-path="data-cleaning-and-manipulation.html"><a href="data-cleaning-and-manipulation.html#setup"><i class="fa fa-check"></i><b>7.3</b> Setup</a></li>
<li class="chapter" data-level="7.4" data-path="data-cleaning-and-manipulation.html"><a href="data-cleaning-and-manipulation.html#selectingremoving-columns-select"><i class="fa fa-check"></i><b>7.4</b> Selecting/removing columns: <code>select()</code></a></li>
<li class="chapter" data-level="7.5" data-path="data-cleaning-and-manipulation.html"><a href="data-cleaning-and-manipulation.html#changing-shape-gather-and-spread"><i class="fa fa-check"></i><b>7.5</b> Changing shape: <code>gather()</code> and <code>spread()</code></a></li>
<li class="chapter" data-level="7.6" data-path="data-cleaning-and-manipulation.html"><a href="data-cleaning-and-manipulation.html#renaming-columns-with-rename"><i class="fa fa-check"></i><b>7.6</b> Renaming columns with <code>rename()</code></a></li>
<li class="chapter" data-level="7.7" data-path="data-cleaning-and-manipulation.html"><a href="data-cleaning-and-manipulation.html#adding-columns-mutate"><i class="fa fa-check"></i><b>7.7</b> Adding columns: <code>mutate()</code></a></li>
<li class="chapter" data-level="7.8" data-path="data-cleaning-and-manipulation.html"><a href="data-cleaning-and-manipulation.html#group_by-and-summarise"><i class="fa fa-check"></i><b>7.8</b> <code>group_by</code> and <code>summarise</code></a></li>
<li class="chapter" data-level="7.9" data-path="data-cleaning-and-manipulation.html"><a href="data-cleaning-and-manipulation.html#filtering-rows-filter"><i class="fa fa-check"></i><b>7.9</b> Filtering rows: <code>filter()</code></a></li>
<li class="chapter" data-level="7.10" data-path="data-cleaning-and-manipulation.html"><a href="data-cleaning-and-manipulation.html#sorting-your-data-arrange"><i class="fa fa-check"></i><b>7.10</b> Sorting your data: <code>arrange()</code></a></li>
<li class="chapter" data-level="7.11" data-path="data-cleaning-and-manipulation.html"><a href="data-cleaning-and-manipulation.html#joins-in-dplyr"><i class="fa fa-check"></i><b>7.11</b> Joins in dplyr</a></li>
<li class="chapter" data-level="7.12" data-path="data-cleaning-and-manipulation.html"><a href="data-cleaning-and-manipulation.html#separate-and-unite"><i class="fa fa-check"></i><b>7.12</b> <code>separate()</code> and <code>unite()</code></a></li>
<li class="chapter" data-level="7.13" data-path="data-cleaning-and-manipulation.html"><a href="data-cleaning-and-manipulation.html#summary"><i class="fa fa-check"></i><b>7.13</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="hands-on-clean-and-integrate-datasets.html"><a href="hands-on-clean-and-integrate-datasets.html"><i class="fa fa-check"></i><b>8</b> Hands On: Clean and Integrate Datasets</a><ul>
<li class="chapter" data-level="8.1" data-path="hands-on-clean-and-integrate-datasets.html"><a href="hands-on-clean-and-integrate-datasets.html#learning-objectives-5"><i class="fa fa-check"></i><b>8.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="8.2" data-path="hands-on-clean-and-integrate-datasets.html"><a href="hands-on-clean-and-integrate-datasets.html#outline"><i class="fa fa-check"></i><b>8.2</b> Outline</a></li>
<li class="chapter" data-level="8.3" data-path="hands-on-clean-and-integrate-datasets.html"><a href="hands-on-clean-and-integrate-datasets.html#high-level-steps"><i class="fa fa-check"></i><b>8.3</b> High-level steps</a><ul>
<li class="chapter" data-level="8.3.1" data-path="hands-on-clean-and-integrate-datasets.html"><a href="hands-on-clean-and-integrate-datasets.html#visual-schematic-of-steps"><i class="fa fa-check"></i><b>8.3.1</b> Visual schematic of steps</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="hands-on-clean-and-integrate-datasets.html"><a href="hands-on-clean-and-integrate-datasets.html#full-solution"><i class="fa fa-check"></i><b>8.4</b> Full solution</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="publication-graphics-with-ggplot2.html"><a href="publication-graphics-with-ggplot2.html"><i class="fa fa-check"></i><b>9</b> Publication Graphics with ggplot2</a><ul>
<li class="chapter" data-level="9.1" data-path="publication-graphics-with-ggplot2.html"><a href="publication-graphics-with-ggplot2.html#learning-objectives-6"><i class="fa fa-check"></i><b>9.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="9.2" data-path="publication-graphics-with-ggplot2.html"><a href="publication-graphics-with-ggplot2.html#overview"><i class="fa fa-check"></i><b>9.2</b> Overview</a></li>
<li class="chapter" data-level="9.3" data-path="publication-graphics-with-ggplot2.html"><a href="publication-graphics-with-ggplot2.html#ggplot-vs-base-vs-lattice-vs-xyz"><i class="fa fa-check"></i><b>9.3</b> ggplot vs base vs lattice vs XYZ…</a></li>
<li class="chapter" data-level="9.4" data-path="publication-graphics-with-ggplot2.html"><a href="publication-graphics-with-ggplot2.html#setup-1"><i class="fa fa-check"></i><b>9.4</b> Setup</a></li>
<li class="chapter" data-level="9.5" data-path="publication-graphics-with-ggplot2.html"><a href="publication-graphics-with-ggplot2.html#geoms-aesthetics"><i class="fa fa-check"></i><b>9.5</b> Geoms / Aesthetics</a></li>
<li class="chapter" data-level="9.6" data-path="publication-graphics-with-ggplot2.html"><a href="publication-graphics-with-ggplot2.html#setting-plot-limits"><i class="fa fa-check"></i><b>9.6</b> Setting plot limits</a></li>
<li class="chapter" data-level="9.7" data-path="publication-graphics-with-ggplot2.html"><a href="publication-graphics-with-ggplot2.html#scales"><i class="fa fa-check"></i><b>9.7</b> Scales</a></li>
<li class="chapter" data-level="9.8" data-path="publication-graphics-with-ggplot2.html"><a href="publication-graphics-with-ggplot2.html#facets"><i class="fa fa-check"></i><b>9.8</b> Facets</a></li>
<li class="chapter" data-level="9.9" data-path="publication-graphics-with-ggplot2.html"><a href="publication-graphics-with-ggplot2.html#plot-customization-w-themes"><i class="fa fa-check"></i><b>9.9</b> Plot customization w/ themes</a></li>
<li class="chapter" data-level="9.10" data-path="publication-graphics-with-ggplot2.html"><a href="publication-graphics-with-ggplot2.html#saving-plots"><i class="fa fa-check"></i><b>9.10</b> Saving plots</a></li>
<li class="chapter" data-level="9.11" data-path="publication-graphics-with-ggplot2.html"><a href="publication-graphics-with-ggplot2.html#bonus-multi-panel-plots-beyond-facets"><i class="fa fa-check"></i><b>9.11</b> Bonus: Multi-panel plots: Beyond facets</a></li>
<li class="chapter" data-level="9.12" data-path="publication-graphics-with-ggplot2.html"><a href="publication-graphics-with-ggplot2.html#bonus-round-two"><i class="fa fa-check"></i><b>9.12</b> Bonus: Round two</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="data-documentation-and-publishing.html"><a href="data-documentation-and-publishing.html"><i class="fa fa-check"></i><b>10</b> Data Documentation and Publishing</a><ul>
<li class="chapter" data-level="10.1" data-path="data-documentation-and-publishing.html"><a href="data-documentation-and-publishing.html#learning-objectives-7"><i class="fa fa-check"></i><b>10.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="10.2" data-path="data-documentation-and-publishing.html"><a href="data-documentation-and-publishing.html#data-sharing-and-preservation"><i class="fa fa-check"></i><b>10.2</b> Data sharing and preservation</a></li>
<li class="chapter" data-level="10.3" data-path="data-documentation-and-publishing.html"><a href="data-documentation-and-publishing.html#data-repositories-built-for-data-and-code"><i class="fa fa-check"></i><b>10.3</b> Data repositories: built for data (and code)</a></li>
<li class="chapter" data-level="10.4" data-path="data-documentation-and-publishing.html"><a href="data-documentation-and-publishing.html#metadata"><i class="fa fa-check"></i><b>10.4</b> Metadata</a></li>
<li class="chapter" data-level="10.5" data-path="data-documentation-and-publishing.html"><a href="data-documentation-and-publishing.html#structure-of-a-data-package"><i class="fa fa-check"></i><b>10.5</b> Structure of a data package</a></li>
<li class="chapter" data-level="10.6" data-path="data-documentation-and-publishing.html"><a href="data-documentation-and-publishing.html#dataone-federation"><i class="fa fa-check"></i><b>10.6</b> DataONE Federation</a></li>
<li class="chapter" data-level="10.7" data-path="data-documentation-and-publishing.html"><a href="data-documentation-and-publishing.html#publishing-data-from-the-web"><i class="fa fa-check"></i><b>10.7</b> Publishing data from the web</a><ul>
<li class="chapter" data-level="10.7.1" data-path="data-documentation-and-publishing.html"><a href="data-documentation-and-publishing.html#download-the-data-to-be-used-for-the-tutorial"><i class="fa fa-check"></i><b>10.7.1</b> Download the data to be used for the tutorial</a></li>
<li class="chapter" data-level="10.7.2" data-path="data-documentation-and-publishing.html"><a href="data-documentation-and-publishing.html#login-via-orcid"><i class="fa fa-check"></i><b>10.7.2</b> Login via ORCID</a></li>
<li class="chapter" data-level="10.7.3" data-path="data-documentation-and-publishing.html"><a href="data-documentation-and-publishing.html#create-and-submit-the-data-set"><i class="fa fa-check"></i><b>10.7.3</b> Create and submit the data set</a></li>
<li class="chapter" data-level="10.7.4" data-path="data-documentation-and-publishing.html"><a href="data-documentation-and-publishing.html#add-workflow-provenance"><i class="fa fa-check"></i><b>10.7.4</b> Add workflow provenance</a></li>
</ul></li>
<li class="chapter" data-level="10.8" data-path="data-documentation-and-publishing.html"><a href="data-documentation-and-publishing.html#publishing-data-from-r"><i class="fa fa-check"></i><b>10.8</b> Publishing data from R</a><ul>
<li class="chapter" data-level="10.8.1" data-path="data-documentation-and-publishing.html"><a href="data-documentation-and-publishing.html#logging-in"><i class="fa fa-check"></i><b>10.8.1</b> Logging in</a></li>
<li class="chapter" data-level="10.8.2" data-path="data-documentation-and-publishing.html"><a href="data-documentation-and-publishing.html#obtain-an-orcid"><i class="fa fa-check"></i><b>10.8.2</b> Obtain an ORCID</a></li>
<li class="chapter" data-level="10.8.3" data-path="data-documentation-and-publishing.html"><a href="data-documentation-and-publishing.html#log-in-to-to-the-test-repository-and-copy-your-token"><i class="fa fa-check"></i><b>10.8.3</b> Log in to to the test repository and copy your token</a></li>
<li class="chapter" data-level="10.8.4" data-path="data-documentation-and-publishing.html"><a href="data-documentation-and-publishing.html#modifying-metadata"><i class="fa fa-check"></i><b>10.8.4</b> Modifying metadata</a></li>
<li class="chapter" data-level="10.8.5" data-path="data-documentation-and-publishing.html"><a href="data-documentation-and-publishing.html#uploading-a-package-using-r-with-uploaddatapackage"><i class="fa fa-check"></i><b>10.8.5</b> Uploading A Package Using R with <code>uploadDataPackage</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="publishing-analyses-to-the-web.html"><a href="publishing-analyses-to-the-web.html"><i class="fa fa-check"></i><b>11</b> Publishing Analyses to the Web</a><ul>
<li class="chapter" data-level="11.1" data-path="publishing-analyses-to-the-web.html"><a href="publishing-analyses-to-the-web.html#learning-objectives-8"><i class="fa fa-check"></i><b>11.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="11.2" data-path="publishing-analyses-to-the-web.html"><a href="publishing-analyses-to-the-web.html#introduction-3"><i class="fa fa-check"></i><b>11.2</b> Introduction</a></li>
<li class="chapter" data-level="11.3" data-path="publishing-analyses-to-the-web.html"><a href="publishing-analyses-to-the-web.html#a-minimal-example"><i class="fa fa-check"></i><b>11.3</b> A Minimal Example</a></li>
<li class="chapter" data-level="11.4" data-path="publishing-analyses-to-the-web.html"><a href="publishing-analyses-to-the-web.html#a-less-minimal-example"><i class="fa fa-check"></i><b>11.4</b> A Less Minimal Example</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Reproducible Analysis With R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="data-documentation-and-publishing" class="section level1">
<h1><span class="header-section-number">10</span> Data Documentation and Publishing</h1>
<div id="learning-objectives-7" class="section level2">
<h2><span class="header-section-number">10.1</span> Learning Objectives</h2>
<p>In this lesson, you will learn:</p>
<ul>
<li>About open data archives</li>
<li>What science metadata is and how it can be used</li>
<li>How data and code can be documented and published in open data archives</li>
</ul>
</div>
<div id="data-sharing-and-preservation" class="section level2">
<h2><span class="header-section-number">10.2</span> Data sharing and preservation</h2>
<p><img src="images/WhyManage.png" /></p>
</div>
<div id="data-repositories-built-for-data-and-code" class="section level2">
<h2><span class="header-section-number">10.3</span> Data repositories: built for data (and code)</h2>
<ul>
<li>GitHub is not an archival location</li>
<li>Dedicated data repositories: KNB, Arctic Data Center, Zenodo, FigShare
<ul>
<li>Rich metadata</li>
<li>Archival in their mission</li>
</ul></li>
<li>Data papers, e.g., Scientific Data</li>
<li>List of data repositories: <a href="http://re3data.org" class="uri">http://re3data.org</a></li>
</ul>
<p><img src="images/RepoLogos.png" /></p>
</div>
<div id="metadata" class="section level2">
<h2><span class="header-section-number">10.4</span> Metadata</h2>
<p>Metadata are documentation describing the content, context, and structure of
data to enable future interpretation and reuse of the data. Generally, metadata
describe who collected the data, what data were collected, when and where it was
collected, and why it was collected.</p>
<p>For consistency, metadata are typically structured following metadata content
standards such as the <a href="https://knb.ecoinformatics.org/software/eml/">Ecological Metadata Language (EML)</a>.
For example, here’s an excerpt of the metadata for a sockeye salmon data set:</p>
<pre class="sourceCode xml"><code class="sourceCode xml"><span class="kw">&lt;?xml</span> version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;<span class="kw">?&gt;</span>
<span class="kw">&lt;eml:eml</span><span class="ot"> packageId=</span><span class="st">&quot;df35d.442.6&quot;</span><span class="ot"> system=</span><span class="st">&quot;knb&quot;</span> 
<span class="ot">    xmlns:eml=</span><span class="st">&quot;eml://ecoinformatics.org/eml-2.1.1&quot;</span><span class="kw">&gt;</span>
    <span class="kw">&lt;dataset&gt;</span>
        <span class="kw">&lt;title&gt;</span>Improving Preseason Forecasts of Sockeye Salmon Runs through 
            Salmon Smolt Monitoring in Kenai River, Alaska: 2005 - 2007<span class="kw">&lt;/title&gt;</span>
        <span class="kw">&lt;creator</span><span class="ot"> id=</span><span class="st">&quot;1385594069457&quot;</span><span class="kw">&gt;</span>
            <span class="kw">&lt;individualName&gt;</span>
                <span class="kw">&lt;givenName&gt;</span>Mark<span class="kw">&lt;/givenName&gt;</span>
                <span class="kw">&lt;surName&gt;</span>Willette<span class="kw">&lt;/surName&gt;</span>
            <span class="kw">&lt;/individualName&gt;</span>
            <span class="kw">&lt;organizationName&gt;</span>Alaska Department of Fish and Game<span class="kw">&lt;/organizationName&gt;</span>
            <span class="kw">&lt;positionName&gt;</span>Fishery Biologist<span class="kw">&lt;/positionName&gt;</span>
            <span class="kw">&lt;address&gt;</span>
                <span class="kw">&lt;city&gt;</span>Soldotna<span class="kw">&lt;/city&gt;</span>
                <span class="kw">&lt;administrativeArea&gt;</span>Alaska<span class="kw">&lt;/administrativeArea&gt;</span>
                <span class="kw">&lt;country&gt;</span>USA<span class="kw">&lt;/country&gt;</span>
            <span class="kw">&lt;/address&gt;</span>
            <span class="kw">&lt;phone</span><span class="ot"> phonetype=</span><span class="st">&quot;voice&quot;</span><span class="kw">&gt;</span>(907)260-2911<span class="kw">&lt;/phone&gt;</span>
            <span class="kw">&lt;electronicMailAddress&gt;</span>mark.willette@alaska.gov<span class="kw">&lt;/electronicMailAddress&gt;</span>
        <span class="kw">&lt;/creator&gt;</span>
        ...
    <span class="kw">&lt;/dataset&gt;</span>
<span class="kw">&lt;/eml:eml&gt;</span></code></pre>
<p>That same metadata document can be converted to HTML format and displayed in a much
more readable form on the web: <a href="https://knb.ecoinformatics.org/#view/doi:10.5063/F1F18WN4" class="uri">https://knb.ecoinformatics.org/#view/doi:10.5063/F1F18WN4</a></p>
<p><img src="images/knb-metadata.png" />
And as you can see, the whole data set or its components can be downloaded and
reused.</p>
<p>Also note that the repository tracks how many times each file has been downloaded,
which gives great feedback to researchers on the activity for their published data.</p>
</div>
<div id="structure-of-a-data-package" class="section level2">
<h2><span class="header-section-number">10.5</span> Structure of a data package</h2>
<p>Note that the data set above lists a collection of files that are contained within
the data set. We define a <em>data package</em> as a scientifically useful collection of
data and metadata that a researcher wants to preserve. Sometimes a data package
represents all of the data from a particular experiment, while at other times it
might be all of the data from a grant, or on a topic, or associated with a paper.
Whatever the extent, we define a data package as having one or more data files,
softare files, and other scientific products such as graphs and images, all tied
together with a descriptive metadata document.</p>
<p><img src="images/data-package.png" />
These data repositories all assign a unique identifier to every version of every
data file, similarly to how it works with source code commits in GitHub. Those identifiers
usually take one of two forms. A <em>DOI</em> identifier is often assigned to the metadata
and becomes the publicly citable identifier for the package. Each of the other files
gets an internal identifier, often a UUID that is globally unique. In the example above,
the package can be cited with the DOI <code>doi:10.5063/F1F18WN4</code>.</p>
</div>
<div id="dataone-federation" class="section level2">
<h2><span class="header-section-number">10.6</span> DataONE Federation</h2>
<p>DataONE is a federation of dozens of data repositories that work together to make their
systems interoperable and to provide a single unified search system that spans
the repositories. DataONE aims to make it simpler for researchers to publish
data to one of its member repositories, and then to discover and download that
data for reuse in synthetic analyses.</p>
<p>DataONE can be searched on the web (<a href="https://search.dataone.org/" class="uri">https://search.dataone.org/</a>), which effectively
allows a single search to find data form the dozens of members of DataONE, rather
than visiting each of the currently 43 repositories one at a time.</p>
<p><img src="images/DataONECNs.png" /></p>
</div>
<div id="publishing-data-from-the-web" class="section level2">
<h2><span class="header-section-number">10.7</span> Publishing data from the web</h2>
<p>Each data repository tends to have its own mechanism for submitting data and
providing metadata. With repositories like the KNB Data Repository and the
Arctic Data Center, we provide some easy to use web forms for editing and submitting
a data package. Let’s walk through a web submission to see what you might expect.</p>
<div id="download-the-data-to-be-used-for-the-tutorial" class="section level3">
<h3><span class="header-section-number">10.7.1</span> Download the data to be used for the tutorial</h3>
<p>I’ve already uploaded the test data package, and so you can access the data here:</p>
<ul>
<li><a href="https://test.arcticdata.io/#view/urn:uuid:630f4bcf-78f6-4c53-b495-b2f6f104202d" class="uri">https://test.arcticdata.io/#view/urn:uuid:630f4bcf-78f6-4c53-b495-b2f6f104202d</a></li>
</ul>
<p>Grab both CSV files, and the R script, and store them in a convenient folder.</p>
</div>
<div id="login-via-orcid" class="section level3">
<h3><span class="header-section-number">10.7.2</span> Login via ORCID</h3>
<p>We will walk through web submission on <a href="https://test.arcticdata.io" class="uri">https://test.arcticdata.io</a>, and start
by logging in with an ORCID account. ORCID provides a common account for sharing
scholarly data, so if you don’t have one, you can create one when you are redirected
to ORCID from the <em>Sign In</em> button.</p>
</div>
<div id="create-and-submit-the-data-set" class="section level3">
<h3><span class="header-section-number">10.7.3</span> Create and submit the data set</h3>
<p>After signing in, you can access the data submission form using the <em>Submit</em> button.
Once on the form, drag your two csv files and R script into the package, and then provide
the required metadata, which is highlighted with a red asterisk. When finished, click
the <em>Submit Dataset</em> button at the bottom. If there are errors or missing fields,
they will be highlighted. Correct those, and then try submitting again.</p>
<p><img src="images/metadata-editor.png" /></p>
</div>
<div id="add-workflow-provenance" class="section level3">
<h3><span class="header-section-number">10.7.4</span> Add workflow provenance</h3>
<p>Understanding the relationships between files in a package is critically important,
especially as the number of files grows. Raw data are transformed and integrated
to produce derived data, that are often then used in analysis and visualization code
to produce final outputs. In DataONE, we support structured descriptions of these
relationships, so one can see the flow of data from raw data to derived to outputs.
Here’s an example from a
<a href="https://search.dataone.org/index.html#view/urn:uuid:3249ada0-afe3-4dd6-875e-0f7928a4c171">hydrocarbon dataset</a>
in Prince William Sound:</p>
<p><img src="images/provenance.png" /></p>
</div>
</div>
<div id="publishing-data-from-r" class="section level2">
<h2><span class="header-section-number">10.8</span> Publishing data from R</h2>
<p>Now lets see how to use the <em>dataone</em> and <em>datapack</em> R packages to upload data to DataONE
member repositories like the <a href="https://knb.ecoinformatics.org">KNB Data Repository</a> and the <a href="https://arcticdata.io">Arctic Data Center</a>.</p>
<p>The <em>dataone</em> R package provides methods to enable R scripts to interact with DataONE to search for, download, upload and update data and metadata. The purpose of uploading data from R is to automate the repetitive tasks for large data sets with many files. For small data sets, the web submission for will certainly be simpler.</p>
<p>The <em>dataone</em> R package represents the set of files in a data set as a <code>datapack::DataPackage</code>. We will create a <code>DataPackage</code> locally, and then upload it to a test version of the Arctic Data Center repository using <code>dataone</code>.</p>
<div id="logging-in" class="section level3">
<h3><span class="header-section-number">10.8.1</span> Logging in</h3>
<p>Before uploading any data to a DataONE repository, you must login to get an <em>authentication token</em>, which is a character string used to identify yourself. This token can be retrieved by logging into the test repository and copying the token into your R session.</p>
</div>
<div id="obtain-an-orcid" class="section level3">
<h3><span class="header-section-number">10.8.2</span> Obtain an ORCID</h3>
<p>ORCID is a researcher identifier that provides a common way to link your researcher identity to your articles and data. An ORCID is to a researcher as a DOI is to a research article. To obtain an ORCID, register at <a href="https://orcid.org" class="uri">https://orcid.org</a>.</p>
</div>
<div id="log-in-to-to-the-test-repository-and-copy-your-token" class="section level3">
<h3><span class="header-section-number">10.8.3</span> Log in to to the test repository and copy your token</h3>
<p>We will be using a test server, so login and retrieve your token at <a href="https://test.arcticdata.io" class="uri">https://test.arcticdata.io</a></p>
<p>Once you are logged in, navigate to your Profile Settings, and locate the “Authentication Token” section, and then copy the token for R to your clipboard.</p>
<p><img src="images/adc-authtoken.png" />
Finally, paste the token into the R Console to register it as an option for this R session. You are now logged in. But note that you need to keep this token private; don’t paste it into scripts or check it into Git, as it is just as sensitive as your password.</p>
</div>
<div id="modifying-metadata" class="section level3">
<h3><span class="header-section-number">10.8.4</span> Modifying metadata</h3>
<p>Next, modify the metadata file associated with the package to set yourself as the owner. This will help us differentiate the test data later. Open the <code>strix-pacific-northwest.xml</code> file in RStudio, and change the <code>givenName</code> and <code>surName</code> fields at the top to your name.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(EML)
<span class="kw">source</span>(<span class="st">&quot;misc/eml_helpers.R&quot;</span>)

<span class="co"># Load the EML file into R</span>
emlFile &lt;-<span class="st"> &quot;data/strix/strix-pacific-northwest.xml&quot;</span>
doc &lt;-<span class="st"> </span><span class="kw">read_eml</span>(emlFile)

<span class="co"># Change creator to us</span>
doc<span class="op">@</span>dataset<span class="op">@</span>creator &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">eml_creator</span>(<span class="st">&quot;Matthew&quot;</span>, <span class="st">&quot;Jones&quot;</span>, <span class="dt">email =</span> <span class="st">&quot;jones@nceas.ucsb.edu&quot;</span>))

<span class="co"># Change abstract to the better one we wrote</span>
doc<span class="op">@</span>dataset<span class="op">@</span>abstract &lt;-<span class="st"> </span><span class="kw">as</span>(<span class="kw">set_TextType</span>(<span class="st">&quot;data/strix/better-abstract.md&quot;</span>), <span class="st">&quot;abstract&quot;</span>)

<span class="co"># Save it back to the filesystem</span>
<span class="kw">write_eml</span>(doc, emlFile)</code></pre>
</div>
<div id="uploading-a-package-using-r-with-uploaddatapackage" class="section level3">
<h3><span class="header-section-number">10.8.5</span> Uploading A Package Using R with <code>uploadDataPackage</code></h3>
<p>Datasets and metadata can be uploaded individually or as a collection. Such a collection, whether contained in local
R objects or existing on a DataONE repository, will be informally referred to as a <code>package</code>. The steps necessary to
to prepare and upload a package to DataONE using the <code>uploadDataPackage</code> method
will be shown. A complete script that uses these steps is shown here.</p>
<p>In the first section, we create a ’DataPackage as a container for our data and metadata and scripts.
It starts out as empty.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(dataone)
<span class="kw">library</span>(datapack)
<span class="kw">library</span>(uuid)

d1c &lt;-<span class="st"> </span><span class="kw">D1Client</span>(<span class="st">&quot;STAGING&quot;</span>, <span class="st">&quot;urn:node:mnTestARCTIC&quot;</span>)
dp &lt;-<span class="st"> </span><span class="kw">new</span>(<span class="st">&quot;DataPackage&quot;</span>)
<span class="kw">show</span>(dp)</code></pre>
<p>We then add a metadata file, data file, R script and output data file to this package.
Our first order is to generate identifiers for the files that are part of the
package, and add EML metadata that references those identifiers.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Generate identifiers for our data and program objects, and add them to the metadata</span>
sourceId &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&quot;urn:uuid:&quot;</span>, uuid<span class="op">::</span><span class="kw">UUIDgenerate</span>())
progId &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&quot;urn:uuid:&quot;</span>, uuid<span class="op">::</span><span class="kw">UUIDgenerate</span>())
outputId &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&quot;urn:uuid:&quot;</span>, uuid<span class="op">::</span><span class="kw">UUIDgenerate</span>())
doc<span class="op">@</span>dataset<span class="op">@</span>otherEntity[[<span class="dv">1</span>]]<span class="op">@</span>id &lt;-<span class="st"> </span><span class="kw">new</span>(<span class="st">&quot;xml_attribute&quot;</span>, sourceId)
doc<span class="op">@</span>dataset<span class="op">@</span>otherEntity[[<span class="dv">2</span>]]<span class="op">@</span>id &lt;-<span class="st"> </span><span class="kw">new</span>(<span class="st">&quot;xml_attribute&quot;</span>, progId)
doc<span class="op">@</span>dataset<span class="op">@</span>otherEntity[[<span class="dv">3</span>]]<span class="op">@</span>id &lt;-<span class="st"> </span><span class="kw">new</span>(<span class="st">&quot;xml_attribute&quot;</span>, outputId)
repo_obj_service &lt;-<span class="st"> </span><span class="kw">paste0</span>(d1c<span class="op">@</span>mn<span class="op">@</span>endpoint, <span class="st">&quot;/object/&quot;</span>)
doc<span class="op">@</span>dataset<span class="op">@</span>otherEntity[[<span class="dv">1</span>]]<span class="op">@</span>physical[[<span class="dv">1</span>]]<span class="op">@</span>distribution[[<span class="dv">1</span>]]<span class="op">@</span>online<span class="op">@</span>url &lt;-<span class="st"> </span>
<span class="st">  </span><span class="kw">new</span>(<span class="st">&quot;url&quot;</span>, <span class="kw">paste0</span>(repo_obj_service, sourceId))
doc<span class="op">@</span>dataset<span class="op">@</span>otherEntity[[<span class="dv">2</span>]]<span class="op">@</span>physical[[<span class="dv">1</span>]]<span class="op">@</span>distribution[[<span class="dv">1</span>]]<span class="op">@</span>online<span class="op">@</span>url &lt;-<span class="st"> </span>
<span class="st">  </span><span class="kw">new</span>(<span class="st">&quot;url&quot;</span>, <span class="kw">paste0</span>(repo_obj_service, progId))
doc<span class="op">@</span>dataset<span class="op">@</span>otherEntity[[<span class="dv">3</span>]]<span class="op">@</span>physical[[<span class="dv">1</span>]]<span class="op">@</span>distribution[[<span class="dv">1</span>]]<span class="op">@</span>online<span class="op">@</span>url &lt;-<span class="st"> </span>
<span class="st">  </span><span class="kw">new</span>(<span class="st">&quot;url&quot;</span>, <span class="kw">paste0</span>(repo_obj_service, outputId))

<span class="kw">write_eml</span>(doc, emlFile)</code></pre>
<p>Now we have a full metadata document ready be uploaded. In the next section, we’ll
add the data files and metadata to a <code>DataPackage</code>, and then upload that to a
test repository.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Add the metadata document to the package</span>
metadataObj &lt;-<span class="st"> </span><span class="kw">new</span>(<span class="st">&quot;DataObject&quot;</span>, 
                   <span class="dt">format=</span><span class="st">&quot;eml://ecoinformatics.org/eml-2.1.1&quot;</span>, 
                   <span class="dt">filename=</span><span class="kw">paste</span>(<span class="kw">getwd</span>(), emlFile, <span class="dt">sep=</span><span class="st">&quot;/&quot;</span>))
dp &lt;-<span class="st"> </span><span class="kw">addMember</span>(dp, metadataObj)

<span class="co"># Add our input data file to the package</span>
sourceData &lt;-<span class="st"> &quot;data/strix/sample.csv&quot;</span>
sourceObj &lt;-<span class="st"> </span><span class="kw">new</span>(<span class="st">&quot;DataObject&quot;</span>,
                 <span class="dt">id =</span> sourceId,
                 <span class="dt">format=</span><span class="st">&quot;text/csv&quot;</span>, 
                 <span class="dt">filename=</span><span class="kw">paste</span>(<span class="kw">getwd</span>(), sourceData, <span class="dt">sep=</span><span class="st">&quot;/&quot;</span>))
dp &lt;-<span class="st"> </span><span class="kw">addMember</span>(dp, sourceObj, metadataObj)

<span class="co"># Add our processing script to the package</span>
progFile &lt;-<span class="st"> &quot;data/strix/filterSpecies.R&quot;</span>
progObj &lt;-<span class="st"> </span><span class="kw">new</span>(<span class="st">&quot;DataObject&quot;</span>,
               <span class="dt">id =</span> progId,
               <span class="dt">format=</span><span class="st">&quot;application/R&quot;</span>, 
               <span class="dt">filename=</span><span class="kw">paste</span>(<span class="kw">getwd</span>(), progFile, <span class="dt">sep=</span><span class="st">&quot;/&quot;</span>), 
               <span class="dt">mediaType=</span><span class="st">&quot;text/x-rsrc&quot;</span>)
dp &lt;-<span class="st"> </span><span class="kw">addMember</span>(dp, progObj, metadataObj)

<span class="co"># Add our derived output data file to the package</span>
outputData &lt;-<span class="st"> &quot;data/strix/filteredSpecies.csv&quot;</span>
outputObj &lt;-<span class="st"> </span><span class="kw">new</span>(<span class="st">&quot;DataObject&quot;</span>, 
               <span class="dt">id =</span> outputId,
               <span class="dt">format=</span><span class="st">&quot;text/csv&quot;</span>, 
               <span class="dt">filename=</span><span class="kw">paste</span>(<span class="kw">getwd</span>(), outputData, <span class="dt">sep=</span><span class="st">&quot;/&quot;</span>))
dp &lt;-<span class="st"> </span><span class="kw">addMember</span>(dp, outputObj, metadataObj)

myAccessRules &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">subject=</span><span class="st">&quot;http://orcid.org/0000-0003-0077-4738&quot;</span>, <span class="dt">permission=</span><span class="st">&quot;changePermission&quot;</span>) 

<span class="co"># Add the provenance relationships to the data package</span>
dp &lt;-<span class="st"> </span><span class="kw">describeWorkflow</span>(dp, <span class="dt">sources=</span>sourceObj, <span class="dt">program=</span>progObj, <span class="dt">derivations=</span>outputObj)

<span class="kw">show</span>(dp)</code></pre>
<p>Finally, we upload the package to the Testing server for the KNB.</p>
<pre class="sourceCode r"><code class="sourceCode r">packageId &lt;-<span class="st"> </span><span class="kw">uploadDataPackage</span>(d1c, dp, <span class="dt">public=</span><span class="ot">TRUE</span>, <span class="dt">accessRules=</span>myAccessRules, <span class="dt">quiet=</span><span class="ot">FALSE</span>)</code></pre>
<p>This particular package contains the R script <code>filterSpecies.R</code>, the input
file <code>sample.csv</code> that was read by the script and the output file
<code>filteredSpecies.csv</code> that was created by the R script, which was run at a
previous time.</p>
<p>You can now search for and view the package at <a href="https://dev.nceas.ucsb.edu" class="uri">https://dev.nceas.ucsb.edu</a>:</p>
<p><img src="images/data-uploaded.png" /></p>
<p>In addition, each of the uploaded entities shows the relevant provenance information, showing how the source data is linked to the derived data via the R program that was used to process the raw data:</p>
<p><img src="images/provenance-info.png" /></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="publication-graphics-with-ggplot2.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="publishing-analyses-to-the-web.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
